var MoveController=function(a,b){var c=this;c.nbOfTilesV=a,c.nbOfTilesH=b,c.moveIfPossible=function(a,b,d){var e=c.possibleMove(a,b);null!=e&&a[b].animateMove(e,function(){c.switchImages(a,b),d()})},c.switchImages=function(a,b){var d=c.getBlankTileIndex(a),e=a[d],f=a[b].clip,g=a[b].clipIndex;a[b].clip=e.clip,a[b].clipIndex=e.clipIndex,a[b].hidden=!0,e.clip=f,e.clipIndex=g,e.hidden=!1,a[b].draw(),e.draw()},c.possibleMove=function(a,b){for(var d=c.getSurroundingTiles(a,b),e=0;e<d.length;e++)if(d[e].hidden)return c.getMoveDirection(a,b);return null},c.getSurroundingTiles=function(a,b){var d=[],e=Math.floor(b/c.nbOfTilesV),f=b%c.nbOfTilesV;return 0==e?0==f?(d.push(a[b+1]),d.push(a[b+c.nbOfTilesV])):f==c.nbOfTilesV-1?(d.push(a[b-1]),d.push(a[b+c.nbOfTilesV])):(d.push(a[b-1]),d.push(a[b+1]),d.push(a[b+c.nbOfTilesV])):e==c.nbOfTilesH-1?0==f?(d.push(a[b+1]),d.push(a[b-c.nbOfTilesV])):f==c.nbOfTilesV-1?(d.push(a[b-1]),d.push(a[b-c.nbOfTilesV])):(d.push(a[b+1]),d.push(a[b-1]),d.push(a[b-c.nbOfTilesV])):0==f?(d.push(a[b-c.nbOfTilesV]),d.push(a[b+c.nbOfTilesV]),d.push(a[b+1])):f==c.nbOfTilesV-1?(d.push(a[b-c.nbOfTilesV]),d.push(a[b+c.nbOfTilesV]),d.push(a[b-1])):(d.push(a[b+1]),d.push(a[b-1]),d.push(a[b+c.nbOfTilesV]),d.push(a[b-c.nbOfTilesV])),d},c.getMoveDirection=function(a,b){var d=c.getBlankTileIndex(a),e=Math.floor(b/c.nbOfTilesV),f=b%c.nbOfTilesV,g=Math.floor(d/c.nbOfTilesV),h=d%c.nbOfTilesV;return e!=g?g>e?Directions.DOWN:Directions.UP:h>f?Directions.RIGHT:Directions.LEFT},c.getBlankTileIndex=function(a){for(var b=-1,c=0;c<a.length;c++)if(a[c].hidden){b=c;break}return b}};